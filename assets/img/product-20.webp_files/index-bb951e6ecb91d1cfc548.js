define(["classnames","react","rendering-engine-api","zalando-consent-api"],(function(e,t,n,a){return(self.renderingEngineWebpackJsonp=self.renderingEngineWebpackJsonp||[]).push([[31972],{80374:function(){window.__RENDERING_ENGINE_TRANSLATION_KEYS__={...window.__RENDERING_ENGINE_TRANSLATION_KEYS__,"app-download-banner":["main.close","download.app.banner.cta","download.app.banner.alt.cta"]}},63225:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Y}});var a=n(32740),r=n(85959),o=n(94179);const l="smart_app_download_banner",s="smart_app_download_banner",c="app_download_banner_exited",i=[1,1,1,1,1],u=[1,1,1,1,.5];function m(e){const t=e.get(l),n={view_count:((null==t?void 0:t.view_count)||0)+1};e.set(l,n,21)}const d={de_AT:430,fr_BE:321,nl_BE:320,de_CH:410,fr_CH:411,cz_CZ:420,de_DE:490,dk_DK:450,es_ES:340,en_IE:353,fi_FI:358,fr_FR:330,it_IT:390,nl_NL:310,no_NO:470,pl_PL:480,pt_PT:351,se_SE:460,en_GB:440,lt_LT:370,sk_SK:421,sl_SI:386,lv_LV:371,et_EE:372,hr_HR:385,hu_HU:360,ro_RO:400},p=["pl-PL","nl-NL","tr-TR","de-CH","fr-CH","it-CH","da-DK","de-DE","en-DE","no-NO","fi-FI","ru-RU","nl-BE","fr-BE","fr-FR","es-ES","it-IT","en-GB","sv-SE","de-AT","en-IE","cs-CZ","lt-LT","sk-SK","sl-SI","lv-LV","et-EE","hr-HR","hu-HU","ro-RO","pt-PT"];function f(e){const{id:t,language:n,domain:a}=function(e){const[t="",n=""]=e.split("-"),a=d[t+"_"+n];return a?{id:a,language:t,domain:n}:{id:490,language:"de",domain:"DE"}}(e),r="orf"+t+"__smartbanner.___.";return"adjust_t=kcry49g_t9wexgj&adjust_campaign="+(a.toLowerCase()+"_"+n+"_smartbanner_1")+"&adjust_adgroup="+r}async function _(e){let{locale:t,appStoreUrl:n}=e,r=!1;try{r=(await(0,a.promiseWithTimeout)((0,o.getConsent)("smart_app_download_banner"),100)).status}catch(e){}if(!r)return n;const l=f(t),s=function(){if("undefined"!=typeof window&&"undefined"!=typeof document){const e=Array.from(document.getElementsByTagName("meta")).find((e=>"al:ios:url"===e.getAttribute("property")));if(null==e?void 0:e.content)return e.content}return"zalando://ROOT"}(),c=encodeURIComponent(s);return"https://Hfe2.adj.st/"+s.replace("zalando://","")+(s.includes("?")?"&":"?")+l+"&adjust_deeplink="+c}var E=n(30812),g=n.n(E),w=n(51599),b=n(42768),v=n(5073),S=n(38856),y=n(87548),h=n(22940),L=n(3906),k=n(58777),x=n(36124),C=n(9049);var N=e=>{let{onClose:t}=e;return r.createElement("div",{className:g()(v.OL,S.Fn,S.n$)},r.createElement(L.A,{"aria-label":__("main.close"),label:__("main.close"),size:"small",preset:k.lH.transparent,onClick:t,type:"button",style:{padding:6,transform:"translateX(-6px)"}},r.createElement(x.A,{src:C.A,style:{width:"0.75rem",height:"0.75rem"}})))},I=n(45259);var R=e=>{let{appRatingArray:t}=e;const n=t.reduce(((e,t)=>e+t),0);return r.createElement("div",{"aria-label":"rating score "+n+" out of 5",role:"img"},t.map(((e,t)=>{let n="StarOutlined";return.5===e?n="StarHalf":e&&(n="StarFilled"),r.createElement(I.A,{key:t,fontSize:"custom",icon:n,size:10,style:{fontSize:"0.625rem",marginRight:2}})})))};var A=()=>r.createElement("svg",{width:"36",height:"36",viewBox:"0 0 36 36",fill:"none",style:{borderRadius:"6px"},"aria-hidden":"true"},r.createElement("path",{fill:"#fff",d:"M0 0h36v36H0z"}),r.createElement("path",{fill:"#ff4c00",d:"M28.34 15.56c-1.59-2-3.82-3.91-6.72-5.65h-.02a24.08 24.08 0 0 0-8.15-3.11c-1.55-.26-2.3.04-2.63.23-.33.2-.96.7-1.52 2.2a25.6 25.6 0 0 0-1.44 8.76V18a25.5 25.5 0 0 0 1.44 8.77c.56 1.48 1.19 2 1.52 2.19.33.19 1.08.49 2.63.23a24 24 0 0 0 8.15-3.1h.02a24.75 24.75 0 0 0 6.72-5.66c1-1.24 1.1-2.05 1.1-2.45 0-.38-.1-1.2-1.1-2.43Z"})),O=n(2673),T=n(52130),F=n(10170);var H=e=>{let{appPlatform:t}=e;const n="ios"===t?"(902k)":"(1.01M)",a="ios"===t?i:u;return r.createElement("div",{className:g()(v.OL,S.Fn),style:{gap:8}},r.createElement("div",{className:g()(v.OL,S.Fn,F.XSc)},r.createElement(A,null)),r.createElement("div",{className:g()(v.OL,S.YV,S.vF,S.XU,S.n$)},r.createElement(O.Ay,{preset:T.nx.bodySmallBold},"Zalando"),r.createElement("div",{className:g()(v.OL,S.lE)},r.createElement(R,{appRatingArray:a}),r.createElement(O.Ay,{style:{padding:2},preset:T.nx.bodyExtraSmall},n))))},P=n(85202);var z=e=>{let{onInstall:t}=e;const[n,a]=r.useState(8.25);return r.useEffect((()=>{const e=()=>{a(window.innerWidth>329?8.25:7.85)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),r.createElement("div",{className:g()(v.OL,S.Gs,S.Fn),style:{flex:"1 0 auto"}},r.createElement(P.j,{role:"link","aria-label":__("download.app.banner.cta")+" "+__("download.app.banner.alt.cta"),label:__("download.app.banner.cta"),onClick:t,style:{padding:8,minWidth:n+"rem"}}))};var B=()=>{const[e,t]=(0,r.useState)(60),n=(0,r.useRef)(null),a=(0,r.useCallback)((()=>{setTimeout((()=>{if(n.current){const e=n.current.offsetHeight;t(e)}}),10)}),[n]);return(0,r.useEffect)((()=>{const e=()=>{requestAnimationFrame(a)};return window.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e)}}),[a]),{bannerRef:n,bannerHeightInPixels:e}},D=n(62030);var G=e=>{const[t,n]=(0,r.useState)((0,a.isBrowser)()),o=(0,r.useRef)(0),[l]=(0,D.A)((()=>{const a=window.scrollY;t&&a>o.current&&n(!1),!t&&a<o.current&&a>e&&n(!0),o.current=a}),20);return(0,r.useEffect)((()=>((0,a.isBrowser)()&&window.addEventListener("scroll",l),()=>{(0,a.isBrowser)()&&window.removeEventListener("scroll",l)})),[l]),t};var j=e=>{let{onInstall:t,onClose:n,appPlatform:o}=e;const[l,s]=r.useState(!1),[c,i]=r.useState(!1),{bannerRef:u,bannerHeightInPixels:m}=B();r.useEffect((()=>{i(!0)}),[]);const d=G(m);return l?null:r.createElement("div",{className:g()(v.cw),style:{minHeight:m+"px"}},c?r.createElement("div",{ref:u,className:g()(d?y._Su:y.cky,y.d7k,b.$3,w.F9z,h.y,v.OL,S.Fn,S.sS,S.rA),style:{rowGap:8,minHeight:"2.5rem",padding:"10px 12px"}},r.createElement("div",{className:g()(v.OL,S.Fn,S.iT,S.sS,S.rA),style:{flex:1,rowGap:8}},r.createElement(z,{onInstall:t}),r.createElement(H,{appPlatform:o})),r.createElement(N,{onClose:()=>{(0,a.requestIdleCallback)((()=>{n(),s(!0)}))}})):null)},U=n(89862);const K="smartbanner";function V(e){return e.split(" ").join("_").toLowerCase()}const W=e=>{let{name:t,customCategory:n,customLabel:a,tools:r,customActionSuffix:o,rolloutFlags:l}=e;r.tracking.track({name:t,context:{customCategory:n,customLabel:a,customActionSuffix:o}},l)};var Y=(0,a.tile)().withTracking((e=>({resolve:()=>({context:{id:e.entity.id}})}))).withRender((e=>{const{tools:t,context:n,ruleData:i}=e,u=t.cookies,d=n.deviceInfo,f=n.locale,E={enableStandaloneInShadow:Boolean(i.enableStandaloneInShadow),enableStandaloneOnly:Boolean(i.enableStandaloneOnly)};if(!d.appPlatform||function(e){return!!e&&!p.some((t=>t.toLowerCase()===e.toLowerCase()))}(f)||function(e){const t=e.get(c),{view_count:n=0}=e.get(l)||{};return t||n>=6}(u))return null;r.useEffect((()=>{!function(e){let t=!1;(0,o.getConsent)(s).then((n=>{n.status&&!t&&(m(e),t=!0),(0,o.subscribe)(s,(n=>{n.status&&!t&&(m(e),t=!0)}))})).catch((()=>{}))}(u)}),[]);return r.createElement(a.ViewTracker,{onVisible:()=>{((e,t,n)=>{const a="smartbanner-"+(t||"");W({name:U.wc,customCategory:K,customLabel:a,tools:e,rolloutFlags:n})})(t,d.appPlatform,E),t.tracking.trackStandalone(function(e){let{platform:t}=e;return{name:"view_content",context:{legacy_event_name:U.wc,event_trigger_name:V("smartbanner-"+(t||""))}}}({platform:d.appPlatform}),E)}},r.createElement(j,{onInstall:async()=>{var e;const n=await _({appStoreUrl:d.appStoreUrl,locale:f});null==(e=window.open(n,"_blank"))||e.focus(),((e,t,n)=>{const a="smartbanner-"+(t||"");W({name:U.bD,customCategory:K,customLabel:a,tools:e,rolloutFlags:n})})(t,d.appPlatform,E),t.tracking.trackStandalone(function(e){let{platform:t}=e;return{name:"select_content",context:{legacy_event_name:U.bD,event_trigger_name:V("smartbanner-"+(t||""))}}}({platform:d.appPlatform}),E)},onClose:()=>{u.set(c,!0,21),((e,t,n)=>{const a="smartbanner-"+(t||"");W({name:U.bD,customCategory:K,customLabel:a,tools:e,customActionSuffix:"close",rolloutFlags:n})})(t,d.appPlatform,E),t.tracking.trackStandalone(function(e){let{platform:t}=e;return{name:"select_content",context:{legacy_event_name:U.bD,event_trigger_name:V("close.smartbanner-"+(t||""))}}}({platform:d.appPlatform}),E)},appPlatform:d.appPlatform}))}))},30812:function(t){"use strict";t.exports=e},85959:function(e){"use strict";e.exports=t},32740:function(e){"use strict";e.exports=n},94179:function(e){"use strict";e.exports=a}},function(e){var t=function(t){return e(e.s=t)};return e.O(0,[29674],(function(){return t(80374),t(63225)})),e.O()}])}));
//# sourceMappingURL=https://zalando.de/dev/source-maps/app-download-banner/index-3596314246c33906f918.map